"use strict";(self["webpackChunkwaffle_backend"]=self["webpackChunkwaffle_backend"]||[]).push([[274],{2274:function(e,t,l){l.r(t),l.d(t,{default:function(){return j}});var a=l(3396),o=l(9242),s=l(7139);const n={class:"row"},i={class:"col-12"},r={class:"card_outStyle radius-10 p-3"},d=(0,a._)("div",{class:"d-flex align-items-center justify-content-between mx-4"},[(0,a._)("h4",{class:"text-white d-flex flex-start my-4"},"結算紀錄")],-1),c={class:"d-flex"},p={class:"text-center justify-content-between mt-3"},h={class:"row"},u={class:"col-12"},m={class:"card_outStyle radius-10 p-4"},f={class:"col-12"},g={class:"d-flex align-items-center justify-content-end"},_={class:"bill_table mt-3"},w=(0,a._)("div",null,"支行名稱:",-1),b={key:0},y=(0,a._)("div",null,"支行名稱:",-1),k={key:1},O={class:"mb-2"},x={class:"setting_style d-flex align-items-center justify-content-center text-yellow"},V=["onClick","onKeydown"],W={class:"d-flex justify-content-end mt-4"},D={class:"d-flex flex-column align-items-start"},v=(0,a._)("span",{class:"mb-2 fs-5 text-deep2"},"日期範圍",-1),z=(0,a._)("span",{class:"mb-2 fs-5"},"時間類型",-1),C=(0,a._)("span",{class:"mb-2 fs-5"},"語言",-1),M=(0,a._)("span",{class:"mb-2 fs-5"},"快速導出",-1),R={class:"d-flex align-self-center"};function U(e,t,l,U,I,P){const A=(0,a.up)("el-option"),S=(0,a.up)("el-select"),$=(0,a.up)("el-form-item"),B=(0,a.up)("el-input"),T=(0,a.up)("el-date-picker"),j=(0,a.up)("el-col"),E=(0,a.up)("el-row"),F=(0,a.up)("el-button"),N=(0,a.up)("el-form"),L=(0,a.up)("el-table-column"),G=(0,a.up)("el-tag"),q=(0,a.up)("el-popover"),Z=(0,a.up)("el-image"),K=(0,a.up)("el-table"),H=(0,a.up)("el-pagination"),Q=(0,a.up)("el-radio-button"),Y=(0,a.up)("el-radio-group"),J=(0,a.up)("el-dialog"),X=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",n,[(0,a._)("div",i,[(0,a._)("div",r,[d,(0,a.Wm)(N,{ref:"search_form",model:I.searchOption,class:"searchForm_style"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(j,{span:24,class:"add_left_style_1 mx-4"},{default:(0,a.w5)((()=>[(0,a._)("div",c,[(0,a.Wm)($,{label:"結算狀態 :",class:"thirdPay_style me-5",prop:"isDone"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{modelValue:I.searchOption.isDone,"onUpdate:modelValue":t[0]||(t[0]=e=>I.searchOption.isDone=e),placeholder:"選擇類型",onChange:t[1]||(t[1]=e=>P.choosePay_type(I.searchOption.isDone)),clearable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{label:"已結算",value:!0}),(0,a.Wm)(A,{label:"未結算",value:!1})])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)($,{label:"收款人 :",class:"thirdPay_style me-5",prop:"id"},{default:(0,a.w5)((()=>[(0,a.Wm)(B,{modelValue:I.searchOption.bankOwner,"onUpdate:modelValue":t[2]||(t[2]=e=>I.searchOption.bankOwner=e),placeholder:"請輸入收款人"},null,8,["modelValue"])])),_:1}),(0,a.Wm)($,{label:"訂單 ID :",class:"thirdPay_style me-5",prop:"merchantBillId"},{default:(0,a.w5)((()=>[(0,a.Wm)(B,{modelValue:I.searchOption.merchantBillId,"onUpdate:modelValue":t[3]||(t[3]=e=>I.searchOption.merchantBillId=e),placeholder:"請輸入訂單ID"},null,8,["modelValue"])])),_:1}),(0,a.Wm)($,{label:"選擇日期 :",class:"thirdPay_style me-5",prop:"timeValue"},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{modelValue:I.timeValue,"onUpdate:modelValue":t[4]||(t[4]=e=>I.timeValue=e),type:"date",placeholder:"選擇日期"},null,8,["modelValue"])])),_:1})])])),_:1})])),_:1}),(0,a._)("div",p,[(0,a.Wm)(F,{color:"#faa30d",class:"search_btn mt-1 px-5 fw-bold",size:"default",onClick:t[5]||(t[5]=(0,o.iM)((e=>P.resetForm()),["prevent"]))},{default:(0,a.w5)((()=>[(0,a.Uk)("重置")])),_:1}),(0,a.Wm)(F,{color:"#faa30d",class:"search_btn mt-1 px-5 fw-bold",size:"default",onClick:t[6]||(t[6]=e=>P.doSearch())},{default:(0,a.w5)((()=>[(0,a.Uk)("查詢")])),_:1})])])),_:1},8,["model"])])])]),(0,a._)("div",h,[(0,a._)("div",u,[(0,a._)("div",m,[(0,a._)("div",f,[(0,a._)("div",g,[(0,a.Wm)(F,{color:"#faa30d",class:"search_btn px-5 fw-bold",size:"default",onClick:t[7]||(t[7]=e=>P.openExcelModal())},{default:(0,a.w5)((()=>[(0,a.Uk)("導出數據")])),_:1})])]),(0,a._)("div",_,[(0,a.wy)(((0,a.wg)(),(0,a.j4)(K,{id:"excelTable",data:I.orderTable,"header-cell-style":{background:"linear-gradient(180deg, rgba(252, 240, 255, 1) 0%, rgba(89, 160, 182, 0.597) 100%)",color:"#606266"},"element-loading-background":"rgba(122, 122, 122, 0.1)"},{default:(0,a.w5)((()=>[(0,a.Wm)(L,{prop:"id",label:"#",align:"center",width:"120"}),(0,a.Wm)(L,{prop:"merchant_bill_id",label:"代付單號",align:"center"}),(0,a.Wm)(L,{prop:"bankOwner",label:"商戶收款訊息",align:"center"},{default:(0,a.w5)((({row:e})=>[(0,a.Wm)(q,{effect:"light",trigger:"hover",placement:"top",width:"auto"},{default:(0,a.w5)((()=>[(0,a._)("div",null,"持卡人: "+(0,s.zw)(e.bankOwner),1),(0,a._)("div",null,"銀行名稱: "+(0,s.zw)(e.bankName),1),w,(0,a._)("div",null,"銀行名稱: "+(0,s.zw)(e.bankAccount),1)])),reference:(0,a.w5)((()=>[(0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.bankOwner),1)])),_:2},1024)])),_:2},1024)])),_:1}),(0,a.Wm)(L,{prop:"mainCardBankOwner",label:"平台出款訊息",align:"center"},{default:(0,a.w5)((({row:e})=>[1===e.isDone?((0,a.wg)(),(0,a.iD)("div",b,[(0,a.Wm)(q,{effect:"light",trigger:"hover",placement:"top",width:"auto"},{default:(0,a.w5)((()=>[(0,a._)("div",null,"持卡人: "+(0,s.zw)(e.mainCardBankOwner),1),(0,a._)("div",null,"銀行名稱: "+(0,s.zw)(e.mainCardBankName),1),y,(0,a._)("div",null,"銀行名稱: "+(0,s.zw)(e.mainCardBankAccount),1)])),reference:(0,a.w5)((()=>[(0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.mainCardBankOwner),1)])),_:2},1024)])),_:2},1024)])):(0,a.kq)("",!0),0===e.isDone?((0,a.wg)(),(0,a.iD)("div",k,[(0,a.Wm)(G,{effect:"dark",type:1===e.isDone?"success":"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(P.formatisDone(e.isDone)),1)])),_:2},1032,["type"])])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(L,{prop:"isDf",label:"結算類型",align:"center"},{default:(0,a.w5)((({row:e})=>[(0,a.Wm)(G,{effect:"dark",type:1===e.isDf?"success":"warning"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(P.formatisDf(e.isDf)),1)])),_:2},1032,["type"])])),_:1}),(0,a.Wm)(L,{sortable:"",prop:"amount",label:"結算金額",align:"center",formatter:P.stateFormat},null,8,["formatter"]),(0,a.Wm)(L,{prop:"bankFee",label:"手續費",align:"center",width:"100",formatter:P.stateFormat},null,8,["formatter"]),(0,a.Wm)(L,{prop:"amount",label:"實結金額",align:"center",formatter:P.stateFormat},null,8,["formatter"]),(0,a.Wm)(L,{prop:"createdAt",label:"創建時間",align:"center"}),(0,a.Wm)(L,{prop:"isDone",label:"狀態",align:"center",width:"150"},{default:(0,a.w5)((({row:e})=>[(0,a.Wm)(G,{effect:"dark",type:1===e.isDone?"success":"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(P.formatisDone(e.isDone)),1)])),_:2},1032,["type"]),1===e.isRefund?((0,a.wg)(),(0,a.j4)(G,{key:0,class:"ms-2",effect:"dark",type:1===e.isRefund?"":"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(P.formatisRefund(e.isRefund)),1)])),_:2},1032,["type"])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(L,{prop:"billType",label:"操作",align:"center",width:"100"},{default:(0,a.w5)((({row:e})=>[(0,a.Wm)(q,{trigger:"click",modelValue:I.photoVisible,"onUpdate:modelValue":t[8]||(t[8]=e=>I.photoVisible=e),placement:"top"},{reference:(0,a.w5)((()=>[(0,a._)("div",x,[(0,a._)("span",{ref:"buttonRef",onClick:t=>P.doResendNotify(e),onKeydown:t=>P.doResendNotify(e)},"查看憑證",40,V)])])),default:(0,a.w5)((()=>[(0,a._)("p",O,"#"+(0,s.zw)(e.id)+"的結算憑證",1),(0,a.Wm)(Z,{style:{width:"100px",height:"100px"},src:e.photos,"zoom-rate":1.5,"preview-src-list":I.urlList,"initial-index":4,fit:"cover"},null,8,["src","zoom-rate","preview-src-list"])])),_:2},1032,["modelValue"])])),_:1})])),_:1},8,["data","header-cell-style"])),[[X,I.loading_table]]),(0,a._)("div",W,[(0,a.Wm)(H,{"page-sizes":[10,30,50,100],layout:"sizes,prev, pager, next",total:I.totalPage,class:"pageStyle d-flex flex-row-reverse","page-size":I.pageSize,"onUpdate:page-size":t[9]||(t[9]=e=>I.pageSize=e),"current-page":I.currentPage,onCurrentChange:P.handleCurrentChange,onSizeChange:P.sizeChange},null,8,["total","page-size","current-page","onCurrentChange","onSizeChange"])]),(0,a.Wm)(J,{class:"excelModel_style",modelValue:I.excelDialogVisible,"onUpdate:modelValue":t[19]||(t[19]=e=>I.excelDialogVisible=e),title:"選擇導出範圍",width:"20%",center:""},{default:(0,a.w5)((()=>[(0,a._)("div",D,[v,(0,a.Wm)(T,{class:"mb-4",modelValue:e.dateRange,"onUpdate:modelValue":t[10]||(t[10]=t=>e.dateRange=t),type:"daterange","range-separator":"to","start-placeholder":"起始日期","end-placeholder":"結束日期"},null,8,["modelValue"]),z,(0,a.Wm)(Y,{class:"mb-4",modelValue:I.radio2,"onUpdate:modelValue":t[11]||(t[11]=e=>I.radio2=e),onChange:t[12]||(t[12]=t=>e.searchDate(I.radio2))},{default:(0,a.w5)((()=>[(0,a.Wm)(Q,{label:"創建時間"}),(0,a.Wm)(Q,{label:"支付時間"})])),_:1},8,["modelValue"]),C,(0,a.Wm)(Y,{class:"mb-4",modelValue:I.radio2,"onUpdate:modelValue":t[13]||(t[13]=e=>I.radio2=e),onChange:t[14]||(t[14]=t=>e.searchDate(I.radio2))},{default:(0,a.w5)((()=>[(0,a.Wm)(Q,{label:"中文"}),(0,a.Wm)(Q,{label:"英文"})])),_:1},8,["modelValue"]),M,(0,a._)("div",R,[(0,a.Wm)(F,{color:"#faa30d",class:"datePick_btn px-5 py-4 mt-4 fw-bold fs-6 align-self-center",size:"small",onClick:t[15]||(t[15]=e=>P.openExcelModal())},{default:(0,a.w5)((()=>[(0,a.Uk)("當日")])),_:1}),(0,a.Wm)(F,{color:"#faa30d",class:"datePick_btn px-5 py-4 mt-4 fw-bold fs-6 align-self-center",size:"small",onClick:t[16]||(t[16]=e=>P.openExcelModal())},{default:(0,a.w5)((()=>[(0,a.Uk)("近三天")])),_:1}),(0,a.Wm)(F,{color:"#faa30d",class:"datePick_btn px-5 py-4 mt-4 fw-bold fs-6 align-self-center",size:"small",onClick:t[17]||(t[17]=e=>P.openExcelModal())},{default:(0,a.w5)((()=>[(0,a.Uk)("近7天")])),_:1})]),(0,a.Wm)(F,{color:"#faa30d",class:"export_btn p-4 mt-4 fw-bold fs-5 align-self-center",size:"default",onClick:t[18]||(t[18]=e=>P.openExcelModal())},{default:(0,a.w5)((()=>[(0,a.Uk)("確認導出")])),_:1})])])),_:1},8,["modelValue"])])])])])],64)}var I=l(4806),P=l.n(I),A=l(6797),S=l.n(A),$={data(){return{searchOption:{bankAccount:null,bankOwner:null,startAt:null,endAt:null,isDone:!1,limit:10,skip:0,mainCardId:null,merchantBillId:null},timeValue:"",radio2:"今天",orderTable:[],totalPage:10,currentPage:1,pageSize:10,excelDialogVisible:!1,excelDate_one:"",excelDate_two:"",type:"createdAt",lang:"chinese",loading_table:!1,photoVisible:!1,url:"http://imgbill.oss-cn-hongkong.aliyuncs.com/6b8533a0-82b0-11ed-921b-f1a45a1c1c52.png",urlList:["https://fuss10.elemecdn.com/a/3f/3302e58f9a181d2509f3dc0fa68b0jpeg.jpeg"]}},methods:{formatisDf(e){return 1===e?"代付":0===e?"下發":"備用"},formatisGotReceipt(e){return 1===e?"已收到回執":0===e?"暫無回執":"備用"},formatisDone(e){return 1===e?"已結算":0===e?"未結算":"備用"},formatisRefund(e){return 1===e?"已撤銷":0===e?"未撤銷":"備用"},choosePay_type(e){console.log(e),!0===e&&(this.searchOption.isDone=!0),"false"===e&&(this.searchOption.isDone=!1),""===e&&(this.searchOption.isDone=null)},chooseReceipt_status(e){console.log(e),!0===e&&(this.searchOption.isGotReceipt=!0),!1===e&&(this.searchOption.isGotReceipt=!1),""===e&&(this.searchOption.isGotReceipt=null)},choose_tunnel(e){console.log(e),7===e&&(this.searchOption.payMethodId=7,console.log("轉卡")),8===e&&(this.searchOption.payMethodId=8,console.log("ZALO")),9===e&&(this.searchOption.payMethodId=9,console.log("MOMO")),10===e&&(this.searchOption.payMethodId=10,console.log("直連")),11===e&&(this.searchOption.payMethodId=11,console.log("銀行掃碼")),12===e&&(this.searchOption.payMethodId=12,console.log("Viettel"))},choose_moneyRange(e){console.log(e),7===e&&(this.searchOption.payMethodId=7,console.log("轉卡")),8===e&&(this.searchOption.payMethodId=8,console.log("ZALO")),9===e&&(this.searchOption.payMethodId=9,console.log("MOMO")),10===e&&(this.searchOption.payMethodId=10,console.log("直連")),11===e&&(this.searchOption.payMethodId=11,console.log("銀行掃碼")),12===e&&(this.searchOption.payMethodId=12,console.log("Viettel"))},stateFormat(e,t,l){let a=l;return a+="",a.includes(".")||(a+="."),a.replace(/(\d)(?=(\d{3})+\.)/g,((e,t)=>`${t},`)).replace(/\.$/,"")},resetForm(){this.$refs.search_form.resetFields(),this.searchOption.isDone=null,this.timeValue=null,this.searchOption.bankOwner="",console.log(this.dateRange)},doSearch(){this.loading_table=!0,console.log(this.radio2),""===this.timeValue||null===this.timeValue?(this.searchOption.startAt=null,this.searchOption.endAt=null):(this.searchOption.startAt=S()(this.timeValue).utc().format(),this.searchOption.endAt=S()(this.timeValue).utc().add(1,"days").format()),console.log(this.timeValue),console.log(this.searchOption.startAt,this.searchOption.endAt),this.$http.post("/api/getMyBills",this.searchOption).then((e=>{this.loading_table=!1,console.log(e.data.data),this.orderTable=e.data.data.dataset,this.totalPage=e.data.data.count,P().forEach(this.orderTable,(e=>{console.log(e.photos.toString()),this.url=e.photos}))}))},verifyRecharge(e){console.log(e),this.notify_id=e.id,this.getOrderNotifies(),console.log(this.notify_id),this.centerDialogVisible=!0},openMerchant(e){console.log(e),this.merchant_notify_url=e.merchant_notify_url,this.merchant_return_url=e.merchant_return_url,this.merchantDialogVisible=!0},getOrderNotifies(){this.$http.get(`/api/getOrderNotifies/${this.notify_id}`).then((e=>{console.log(e.data.data),this.notifyList_Data=e.data.data.dataset}))},doResendNotify(e){console.log(e),this.photoVisible=!0},handleCurrentChange(e){this.currentPage=e,e<=1?(this.searchOption.skip=0,console.log(e),this.doSearch()):e>1&&(this.searchOption.skip=10*(e-1),console.log(this.searchOption.skip),this.doSearch())},sizeChange(e){console.log(e),this.searchOption.limit=e,this.currentPage=1},openExcelModal(){this.excelDialogVisible=!0},getExcel(){this.dateRange[0]=S()(this.dateRange[0]).utc().format(),this.dateRange[1]=S()(this.dateRange[1]).utc().format(),this.excelDate_one=this.$filters.dateTime(this.dateRange[0]),this.excelDate_two=this.$filters.dateTime(this.dateRange[1]),console.log(this.excelDate_one),console.log(this.excelDate_two),window.open(`/api/getOrderExcel/${this.excelDate_one}to${this.excelDate_two}.csv?dateType=${this.type}&lang=${this.lang}`,"_blank;")},test(e){console.log(e.pgType)}},created(){this.doSearch()}},B=l(89);const T=(0,B.Z)($,[["render",U]]);var j=T}}]);
//# sourceMappingURL=274.d4256e07.js.map